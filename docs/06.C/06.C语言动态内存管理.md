---
title: 06.C语言动态内存管理
date: 2025-10-16 10:00:00
permalink: /pages/C_06/
---

众所周知，C语言可以动态地管理内存，至于，怎么分配，分配多少，这取决于程序员自己的决定。进行内存管理操作时，要引入标准库头文件 `<stdlib.h>`

C语言提供了如下的几个函数用于优雅地进行内存管理操作：

+ **void \*malloc(int num);**
  在堆区分配一块指定大小的内存空间，用来存放数据。这块内存空间在函数执行完成后不会被初始化，它们的值是未知的。
+ **void free(void \*address); **  该函数释放 address 所指向的内存块,释放的是动态分配的内存空间。
+ **void \*calloc(int num, int size);** 在内存中动态地分配 num 个长度为 size 的连续空间，并将每一个字节都初始化为 0。所以它的结果是分配了 num*size 个字节长度的内存空间，并且每个字节的值都是 0。
+ **void \*realloc(void \*address, int newsize);**
  该函数重新分配内存，把内存扩展到 **newsize**。

如下是一个将若干名字保存到动态内存中的例子：

```c
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

int main() {
    int count;
    printf("请输入名字的数量: ");
    scanf("%d", &count);

    // 分配指针数组
    char **names = malloc(count * sizeof(char *));
    if (names == NULL) {
        fprintf(stderr, "内存分配失败！\n");
        return 1;
    }

    // 为每个名字分配空间
    for (int i = 0; i < count; i++) {
        char temp[100];
        printf("请输入第 %d 个名字: ", i + 1);
        scanf("%s", temp);

        names[i] = malloc(strlen(temp) + 1);
        if (names[i] == NULL) {
            fprintf(stderr, "内存分配失败！\n");
            return 1;
        }
        strcpy(names[i], temp);
    }

    printf("\n--- 你输入的名字如下 ---\n");
    for (int i = 0; i < count; i++) {
        printf("%s\n", names[i]);
        free(names[i]);  // 释放每个名字的内存
    }

    free(names);  // 释放指针数组
    return 0;
}

```

