---
title: 3.K230 FPIOA&GPIO - 一切的根源
date: 2025-06-17 21:17:49
permalink: /pages/K230_03/
---

# FPIOA & GPIO - 一切的根源

## 1. 本节介绍

📝 本节你将学习如何通过控制开发板的 GPIO 引脚，实现对 RGB 灯和按键的控制，从此走上点灯的不归路。

🎯 学习目标：

1️⃣ 掌握 GPIO 的**输出模式**，点亮 RGB 灯，耍酷从灯开始。  
2️⃣ 理解 GPIO 的**输入模式**，检测按键状态，实现交互逻辑。

## 2. 名词解释

| 名词     | 说明                           |
| -------- | ------------------------------ |
| GPIO     | 通用输入输出引脚，芯片的“手脚” |
| FPIOA    | 可编程IO阵列，芯片的“排插板”   |
| iomux    | 引脚复用选择器，控制信号接线图 |
| Pin 模块 | MicroPython 中操作 GPIO 的接口 |

## 3. GPIO 与 FPIOA 的关系

在 K230 上，GPIO 是实际控制硬件的接口，而 FPIOA 是让 GPIO 能连接到物理引脚的“跳线板”。

- 没有配置 FPIOA，GPIO 就像是在空气里挥拳，啥也打不到；
- 配了 FPIOA，才能让芯片内部的功能信号“走出去”。

通俗理解：  
👉 FPIOA = 把“GPIO 3号”拉一根线接到“物理引脚 IO62”。  
👉 GPIO = 控制这条线通电不通电（点灯 or 熄灯）。

## 4. 基础代码示例

```python
from machine import Pin, FPIOA
import time

fpioa = FPIOA()

# 把内部的 GPIO 功能 映射 到 具体引脚
fpioa.set_function(62, FPIOA.GPIO62)
fpioa.set_function(20, FPIOA.GPIO20)
fpioa.set_function(63, FPIOA.GPIO63)
fpioa.set_function(53, FPIOA.GPIO53)

# 创建 RGB 灯输出引脚对象（共阳极LED，高电平灭）
LED_R = Pin(62, Pin.OUT, pull=Pin.PULL_NONE, drive=7)
LED_G = Pin(20, Pin.OUT, pull=Pin.PULL_NONE, drive=7)
LED_B = Pin(63, Pin.OUT, pull=Pin.PULL_NONE, drive=7)

# 创建按键输入引脚（默认下拉）
button = Pin(53, Pin.IN, Pin.PULL_DOWN)
```

## 5. 按键控制 RGB 灯状态

```python
LED = LED_R  # 默认控制红灯

LED_R.high()
LED_G.high()
LED_B.high()

debounce_delay = 20  # ms 消抖
last_press_time = 0
led_on = False
button_last_state = 0

while True:
    button_state = button.value()
    current_time = time.ticks_ms()

    if button_state == 1 and button_last_state == 0:
        if current_time - last_press_time > debounce_delay:
            if led_on:
                LED.high()  # 灯灭
            else:
                LED.low()   # 灯亮
            led_on = not led_on
            last_press_time = current_time

    button_last_state = button_state
    time.sleep_ms(10)
```

## 6. 代码解析

🧩 **FPIOA配置**：
 用 `.set_function()` 把 GPIO 功能接到你选的引脚上，像电工布线。

⚙️ **GPIO设置**：
 用 `Pin()` 实例设置引脚为输出或输入，还能加上拉/下拉电阻、驱动强度等。

🧼 **按键消抖**：
 人按按钮不是“0→1”干净切换，中间会抖动，需要延迟过滤。

💡 **LED 控制逻辑**：
 `low()` 是点亮（因为共阳LED），`high()` 是熄灭。

## 7. 注意事项

❗ 必须先配置 FPIOA，再用 GPIO，否则灯不会亮。
 ❗ 按键要加消抖逻辑，否则你会变成“频繁开灯人”。
 ❗ 共阳极LED = 高电平灭灯，低电平点亮。
 ❗ 驱动强度可以调节，通常设为 7 是最大驱动，LED更亮。

## 8. 参考资料

- 📘 [Pin 模块 API 手册（MicroPython）](https://docs.micropython.org/en/latest/library/machine.Pin.html)
- 📘 K230 FPIOA 模块 API 文档（庐山派）
- 📄 庐山派文档：GPIO/按键部分（学习参考，不搬运）

------

> 📬 如果你调通了灯，建议你去夜里拉个窗帘拍照，因为你已经点亮了“芯片世界”的第一盏灯。如果你还没调通，那我建议你检查一下有没有配置 FPIOA 😅。