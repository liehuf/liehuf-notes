---
title: 18.Verilog HDL序列信号发生器
date: 2025-08-13 15:20:00
permalink: /pages/Verilog_18/
---

# **序列信号发生器：数字电路的“节奏编曲器”**

## **1. 基本概念**

序列信号发生器是能按照**预设规律**产生一串二进制信号的时序电路。  
它常用于通信码型生成、测试波形输出、序列控制等场景。

常见实现方式有三种：
1. **移位寄存器型**
2. **反馈组合型**
3. **计数器型**

---

## **2. 移位寄存器型**

- **原理**：把整个序列**直接存储**在寄存器中，通过移位依次输出。
- **优点**：速度快，实现简单。
- **缺点**：需要较多触发器（存储量大），不适合超长序列。

### **Verilog 示例**

```verilog
module seq_gen_shift #(
    parameter N = 8          // 序列位数
)(
    input  wire clk,
    input  wire rst_n,
    input  wire [N-1:0] seq_init, // 序列初始值
    output wire seq_out
);
    reg [N-1:0] shift_reg;

    always @(posedge clk or negedge rst_n) begin
        if (!rst_n)
            shift_reg <= seq_init;                 // 加载序列
        else
            shift_reg <= {shift_reg[N-2:0], shift_reg[N-1]}; // 循环移位
    end

    assign seq_out = shift_reg[N-1];  // 输出最高位
endmodule
```

## **3. 反馈组合型**

- **原理**：用移位寄存器+组合逻辑反馈实现序列生成。

- **优点**：存储量小，可产生长序列（典型如 LFSR）。

- **设计步骤**：

  1. 根据序列长度 `M` 确定寄存器位数 `N`。

  2. 列出状态序表。

  3. 根据序列规律推导**反馈函数**。
      例如：

     ```ini
     F = Q3 + Q0·Q1 + Q2·Q3
     ```

     表示反馈信号由这几个触发器状态组合而成。

### **Verilog 框架**

```verilog
module seq_gen_feedback (
    input  wire clk,
    input  wire rst_n,
    output reg  [3:0] Q
);
    wire F; // 反馈信号

    assign F = Q[3] | (Q[0] & Q[1]) | (Q[2] & Q[3]); // 示例反馈函数

    always @(posedge clk or negedge rst_n) begin
        if (!rst_n)
            Q <= 4'b0001;             // 初始状态
        else
            Q <= {Q[2:0], F};         // 移位 + 反馈
    end
endmodule
```

------

## **4. 计数器型**

- **原理**：用计数器按顺序切换状态，然后通过组合逻辑生成所需输出。
- **优点**：实现灵活，可生成任意规律信号。
- **缺点**：对于非常长序列，组合逻辑可能复杂。

### **Verilog 示例**

```verilog
module seq_gen_counter #(
    parameter M = 8 // 序列长度
)(
    input  wire clk,
    input  wire rst_n,
    output reg  seq_out
);
    reg [$clog2(M)-1:0] cnt;

    always @(posedge clk or negedge rst_n) begin
        if (!rst_n)
            cnt <= 0;
        else if (cnt == M-1)
            cnt <= 0;
        else
            cnt <= cnt + 1;
    end

    // 根据计数值输出序列（示例：预定义8位序列 10110011）
    always @(*) begin
        case (cnt)
            0: seq_out = 1'b1;
            1: seq_out = 1'b0;
            2: seq_out = 1'b1;
            3: seq_out = 1'b1;
            4: seq_out = 1'b0;
            5: seq_out = 1'b0;
            6: seq_out = 1'b1;
            7: seq_out = 1'b1;
        endcase
    end
endmodule
```

------

## **5. 小结**

- **移位寄存器型**：直接存储，速度快，占用面积大。
- **反馈组合型**：存储少，可产生长序列，典型应用是 LFSR。
- **计数器型**：灵活，但输出逻辑可能复杂。

> 不同实现方式，就像不同的编曲手法——目标曲子一样，但乐器选择和演奏方式不同。