---
title: 3.05.UART-发送和接收
date: 2025-06-15 13:40:49
permalink: /pages/k230_05/
---

# K230 UART通信：发送和接收

## 1. UART简介

UART（Universal Asynchronous Receiver-Transmitter，通用异步收发传输器）是一种常用的串行通信协议。在嵌入式系统中，UART被广泛应用于微控制器、传感器和调试接口等场景。

UART通信的主要特点：
- 异步通信：不需要时钟信号同步
- 使用两条线进行数据传输：
  - TXD（Transmit Data）：数据发送端
  - RXD（Receive Data）：数据接收端

## 2. UART通信参数

### 2.1 基本参数
- 波特率：通信速度，常用值包括115200、9600等
- 数据位：通常为8位
- 停止位：通常为1位
- 校验位：可选（无校验、奇校验、偶校验）

### 2.2 K230 UART配置
K230支持多个UART接口，每个接口都可以独立配置。配置步骤：

1. 引脚复用配置
2. UART参数初始化
3. 数据收发操作

## 3. 代码示例

### 3.1 基本配置
```python
from machine import UART
from machine import FPIOA

# 配置引脚
fpioa = FPIOA()
fpioa.set_function(11, FPIOA.UART2_TXD)  # 配置GPIO11为UART2_TXD
fpioa.set_function(12, FPIOA.UART2_RXD)  # 配置GPIO12为UART2_RXD

# 初始化UART2
uart = UART(UART.UART2, 
            baudrate=115200,    # 波特率
            bits=UART.EIGHTBITS,    # 数据位
            parity=UART.PARITY_NONE,    # 校验位
            stop=UART.STOPBITS_ONE)    # 停止位
```

### 3.2 数据发送
```python
# 发送字符串
uart.write("Hello, UART!")

# 发送字节数据
uart.write(b'\x01\x02\x03')
```

### 3.3 数据接收
```python
# 读取数据
data = uart.read()
if data:
    print("Received:", data)
```

### 3.4 回环测试示例
```python
import time

# 发送测试数据
test_message = b'UART Loopback Test!'
uart.write(test_message)

# 等待数据发送完成
time.sleep(0.1)

# 读取接收到的数据
received_data = uart.read()

if received_data:
    if received_data == test_message:
        print("回环测试成功！")
    else:
        print("回环测试失败：数据不匹配")
else:
    print("回环测试失败：未接收到数据")
```

## 4. 注意事项

1. 确保正确配置引脚复用功能
2. 通信双方使用相同的波特率和其他参数
3. 注意数据发送和接收的时序
4. 合理使用延时确保数据完整性
5. 使用完毕后及时释放UART资源

## 5. 常见问题

1. 数据接收不完整
   - 检查波特率设置
   - 增加接收缓冲区大小
   - 适当增加延时时间

2. 通信不稳定
   - 检查硬件连接
   - 确认电平匹配
   - 检查电源稳定性

## 6. 参考资料

1. K230官方文档
2. UART通信协议规范
3. MicroPython UART模块文档 