---
title: C1.C语言的编译过程
date: 2025-10-08 23:00:00
permalink: /pages/C_01/
---

C语言编译的过程一般分为四个步骤：
+ 预处理(Preprocessing)
+ 编译(Compliation)
+ 汇编(Assembly)
+ 链接(Linking)

## 1、预处理(Preprocessing)

如下是一个最简单的C语言代码:
```C
#include <stdio>

int main()
{
	printf("Hello World!");
	return 0;
}
```

+ 本程序中，`#include <stdio.h>`是一个预处理指令，告诉编译器要引入标准输入输出的头文件
+ 预处理器会处理这些指令，包括替换所有的宏定义、处理文件包含（#include）、处理条件编译指令(`#if`, #else,`#endif`)

预处理之后，会把`stdio.h`的内容插入到源代码里面，文件的后缀为.i，准备进行编译。

## 2、编译(Complilation)

编译器将预处理后的源代码转换成汇编语言代码。其主要任务是：
+ 语法分析：检查C语言源代码的语法规则
+ 语义分析：变量的使用、数据类型
+ 优化：尽可能提高程序的效率

本阶段后，代码变成如下的形式，真·精简版汇编，以.s位后缀：
```assembly
MOV R0, #0
MOV R1, #1
...
```

## 3、汇编(Assembly)

将编译过后的机器码转换成由`0`和`1`构成的机器码，也可叫做目标文件，通常以`.o`或者`.obj`结尾，这个文件包含了计算机能够直接执行的机器代码。

## 4、链接(Linking)

连接器负责将程序中引用的外部库和其他源文件链接到目标文件中。比如，`printf`是定义在`stdio`库中的，而编译过后的目标文件没有，因此连接器会：
+ 查找库函数代码
+ 将多个目标文件连接成一个完整的可执行文件
+ 处理符号引用
最后，形成一个可执行文件，一般是`a.out`或`a.exe`,这时候，代码就可以运行了，黑色终端里面就`printf`出了`Hello World`。