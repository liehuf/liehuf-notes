---
title: 09.Rust的结构体的打印与调试
date: 2025-08-22 20:00:00
permalink: /pages/Rust_09/
---

# Rust的结构体的 **println** 该如何办？

当我们写了如下代码，

```rust
struct Rectangle {
    width: u32,
    height: u32,
}

fn main() {
    let rect = Rectangle {
        width: 20,
        height: 40,
    };

    println!("rect is {}", rect);
}
```



并且尝试 **cargo run**时，编译器通常会抱怨：

```bash
error[E0277]: `Rectangle` doesn't implement `std::fmt::Display`
```

显然是不能这样玩的，因为编译器并不知道要用什么样的形式把它打印出来。就比如你去汉武大学的图书馆借书，你要是光跟管理员同志说一句借书，显然这位同志只会认为来的是一个糟糕的人。

---

同理，我们用 **Debug** 来优雅地打印出结构体。

## 一、使用 `{:?}` 或 `{:#?}`

首先，我们在程序开头添加：

```rust
#[derive(Debug)]
```

然后，把 **println!** 宏改成类似于

```rust
println!("rect1 is {rect:?}");
```

或者

```rust
println!("rect1 is {rect1:#?}");
```

两种结果的输出是有点差异的，读者可以自己调试一哈。

## 二、[`dbg!` 宏]

没错，还是如下的代码：
```rust
#[derive(Debug)]
struct Rectangle {
    width: u32,
    height: u32,
}

fn main() {
    let scale = 4;
    let rect = Rectangle {
        width: dbg!(20 * scale),
        height: 40,
    };

    dbg!(&rect);
}
```

这样子，在`cargo run`之后，就会是如下的结果：

```bash
[src/main.rs:10:16] 20 * scale = 80
[src/main.rs:14:5] &rect1 = Rectangle {
    width: 80,
    height: 40,
}
```

