---
title: 11.Rust的枚举
date: 2025-08-23 20:00:00
permalink: /pages/Rust_11/
---

# Rust 的枚举（Enum）与 Option：给数据贴标签的艺术

在编程世界里，有时候我们希望数据不只是个值，还要有个“身份”或“状态”。  
Rust 里就有一种强力武器：**枚举（Enum）**。它能把有限的几种可能性收拢起来，编译器帮你保证不会出岔子。

---

## 一、枚举（Enum）是啥？

**枚举**就是一类“只能在有限选项中挑一个”的数据类型。  
想象一下，你有个状态机：红灯、绿灯、黄灯。我们可以这样写：

```rust
enum TrafficLight {
    Red,
    Yellow,
    Green,
}
```

当我们定义一个变量：

```rust
let light = TrafficLight::Red;
```

这就表示当前信号灯是“红色”。
 优势是什么？——它不可能变成什么 `"blue"` 之类莫名其妙的状态。

## 二、枚举还能带点“行李”

枚举不仅能表示“是哪一类”，还可以顺便带上额外数据。
 举个例子：我们做一个消息系统，有三种可能：

- 空消息
- 文本消息
- 坐标消息

在 Rust 里可以这么写：

```rust
enum Message {
    Empty,
    Text(String),
    Position(i32, i32),
}
```

使用的时候：

```rust
let m1 = Message::Empty;
let m2 = Message::Text(String::from("Hello!"));
let m3 = Message::Position(10, 20);
```

这样数据和分类合体，逻辑更清楚。

------

## 三、Rust 内置的明星枚举：Option

在别的语言里，如果某个值“可能没有”，通常会用 `null`。
 但是 Rust 没有 `null`，而是用 `Option` 来表达“有或没有”。

```rust
enum Option<T> {
    Some(T),
    None,
}
```

这就是 Rust 标准库里 Option 的定义。

- `Some(T)`：表示里面有一个值 T；
- `None`：表示啥也没有。

用例子感受一下：

```rust
let some_number = Some(5);
let some_text = Some("Hello");
let no_value: Option<i32> = None;
```

这里的 `some_number` 就是“有值 5”，`no_value` 就是“啥都没有”。

------

## 四、为什么 Option 比 null 更靠谱？

- 在 Rust 里，`Option` 是一个显式的类型，你在写代码时必须处理“有值”和“没值”的情况；
- 它避免了像其他语言那样，一不小心解引用 `null` 就崩溃的尴尬。

比如说：
 你写了一个函数，它要么找到某个元素返回它，要么啥也找不到。
 返回 `Option<T>` 就再合适不过。

```rust
fn find_index(arr: &[i32], target: i32) -> Option<usize> {
    for (i, &item) in arr.iter().enumerate() {
        if item == target {
            return Some(i);
        }
    }
    None
}
```

这样调用：

```rust
let nums = vec![10, 20, 30];
let pos = find_index(&nums, 20);
```

这里 `pos` 的类型是 `Option<usize>`，要么 `Some(1)`，要么 `None`。
