---
title: 13.Rust 的语法糖 - if let
date: 2025-08-21 21:00:00
permalink: /pages/Rust_13/
---

# **Rust 的语法糖 - `if let`**

## 一、if let 是个啥？

在学习 `match` 的时候，你可能觉得它有点啰嗦：  
有时候我只关心一个分支，结果写一大堆 `_ => ()`，又长又丑。  

这时候，Rust 贴心地给你塞了一个小糖果：**`if let`**。  
它其实就是 **“只关注一个模式的 match”** 的缩写。

---

## 二、举个例子：盒子开宝藏

假设我们有个神秘的盒子，它可能藏着一个数字宝藏，也可能什么都没有：

```rust
enum Boxed {
    Treasure(i32),
    Empty,
}

fn main() {
    let my_box = Boxed::Treasure(42);

    // 只关心有宝藏的情况
    if let Boxed::Treasure(v) = my_box {
        println!("我发现了宝藏，价值 {}!", v);
    }
}
```

如果写成 `match` 的话呢？

```rust
match my_box {
    Boxed::Treasure(v) => println!("我发现了宝藏，价值 {}!", v),
    _ => (),
}
```

看出来没？**`if let`** 就是上面这坨的简洁版。

------

## 三、Option 与 if let

`Option` 是 Rust 里常见的枚举，代表“可能有值，可能没有值”。
 假设我们想要在有值的时候处理一下：

```rust
fn main() {
    let maybe_num = Some(10);

    if let Some(x) = maybe_num {
        println!("有数字！它是 {}", x);
    }
}
```

相当于只关心 `Some`，而对 `None` 不想管。
 如果用 `match`，就得多写一行 `None => ()`，显得很啰嗦。

------

## 四、还能配合 else

`if let` 还能带个 `else`，就像普通 if 一样：

```rust
fn main() {
    let maybe_name = None;

    if let Some(name) = maybe_name {
        println!("你好, {}", name);
    } else {
        println!("没有名字，只能叫你匿名侠了！");
    }
}
```

是不是很优雅？

------

## 五、什么时候用 if let，什么时候用 match？

- 如果你只关心一种情况，`if let` 更简洁。
- 如果你需要覆盖所有可能，**必须用 `match`**，这样编译器能帮你检查穷举。

一句话总结：

> **if let 是 match 的快捷写法，适合偷懒的时候。**

------

## 六、脑洞一下

你可以把 `if let` 理解为一种“有条件的解锁”：

- 如果钥匙对得上（模式匹配成功），就开门干活；
- 如果钥匙不对（匹配失败），就悄悄走开，不打扰别人。

这，就是 Rust 给我们的小小语法糖。