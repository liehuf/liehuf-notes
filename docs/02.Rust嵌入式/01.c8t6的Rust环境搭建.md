---
title: 1.c8t6çš„Rustç¯å¢ƒæ­å»º
date: 2025-06-27 9:22:49
permalink: /pages/Rust_01/
---

# ğŸš€ åœ¨ Windows ä¸Šä¸º STM32F103C8T6 å®‰è£… Rust å·¥å…·é“¾ï¼ˆ2025 æœ€æ–°ç‰ˆï¼‰

Rust æƒ³ç©åµŒå…¥å¼ï¼Ÿé‚£å¿…é¡»å¾—ä¸Š ARM Cortex-M ç³»åˆ—æ¿å­â€”â€”ç»å…¸ä¸­çš„ç»å…¸ï¼Œ**STM32F103C8T6ï¼ˆä¿—ç§°â€œè“ä¸æ¿â€ï¼‰**å°±æ˜¯å…¥å‘çš„é¦–é€‰ã€‚æœ¬ç¯‡æ–‡ç« æ‰‹æŠŠæ‰‹æ•™ä½ å¦‚ä½•åœ¨ Windows ä¸Šä¸ºå®ƒé…ç½® Rust å·¥å…·é“¾ï¼Œè®©ä½ çš„ `main.rs` æ¯”è£¸æœº C è¿˜å¹²å‡€åˆ©è½ã€‚

## ğŸ§± å‰æå‡†å¤‡

ç¡®ä¿ä½ å·²ç»å®‰è£…å¥½ï¼š

- Rust å®˜æ–¹å·¥å…·é“¾ï¼ˆç”¨ rustup å®‰è£…ï¼Œé»˜è®¤å³å¯ï¼‰
- VSCode + rust-analyzerï¼ˆå¯é€‰ä½†æ¨èï¼‰
- ST-Link è°ƒè¯•å™¨ï¼ˆçƒ§å½•ç”¨ï¼‰

å‘½ä»¤è¡Œç¡®è®¤ Rust å®‰è£…æˆåŠŸï¼š

```bash
rustc --version
cargo --version
```

------

## ğŸ› ï¸ ç¬¬ä¸€æ­¥ï¼šæ·»åŠ ç›®æ ‡æ¶æ„

STM32F103 å±äº Cortex-M3 å†…æ ¸ï¼Œç”¨çš„æ˜¯ `thumbv7m-none-eabi` æ¶æ„ã€‚

æ‰§è¡Œå‘½ä»¤ï¼š

```bash
rustup target add thumbv7m-none-eabi
```

------

## ğŸ”§ ç¬¬äºŒæ­¥ï¼šå®‰è£…äº¤å‰ç¼–è¯‘å·¥å…·é“¾ï¼ˆGCCï¼‰

Rust ç¼–è¯‘å™¨æœ¬èº«ä¸å¸¦ linkerï¼Œéœ€è¦ ARM çš„è£¸æœºå·¥å…·é“¾ã€‚

ä½ å¯ä»¥å®‰è£…ï¼š

### æ–¹æ³•1ï¼šxPack Arm Toolchainï¼ˆæ¨èï¼‰

è®¿é—®ï¼š

> https://xpack.github.io/arm-none-eabi-gcc/install/

ä¸‹è½½ Windows ç‰ˆï¼Œå®‰è£…åå°†å…¶ `bin` ç›®å½•æ·»åŠ åˆ°ç³»ç»Ÿç¯å¢ƒå˜é‡ `PATH`ã€‚

æ¯”å¦‚ï¼š

```bash
D:\xpack-arm-none-eabi-gcc\bin
```

éªŒè¯æ˜¯å¦å®‰è£…æˆåŠŸï¼š

```bash
arm-none-eabi-gcc --version
```

------

## ğŸ”Œ ç¬¬ä¸‰æ­¥ï¼šå®‰è£… probe-rs å’Œ cargo-flash

ç”¨äº**è¯»å–èŠ¯ç‰‡ä¿¡æ¯ã€çƒ§å½•ç¨‹åºã€è°ƒè¯•**ç­‰åŠŸèƒ½ã€‚

```bash
cargo install cargo-binutils
rustup component add llvm-tools-preview
cargo install probe-rs
cargo install cargo-flash
```

------

## ğŸ” ç¬¬å››æ­¥ï¼šç¡®è®¤è°ƒè¯•å™¨æ˜¯å¦è¿æ¥

æ’å¥½ ST-Linkï¼Œä½¿ç”¨ï¼š

```bash
cargo flash --list-probes
```

èƒ½çœ‹åˆ°è®¾å¤‡ä¿¡æ¯å°±è¯´æ˜ä½ çš„è°ƒè¯•å™¨è¿æ¥æ­£å¸¸ã€‚

------

## ğŸ“¦ ç¬¬äº”æ­¥ï¼ˆå¯é€‰ï¼‰ï¼šåˆ›å»ºä¸€ä¸ªæµ‹è¯•é¡¹ç›®

```bash
cargo new f103-blink --bin
cd f103-blink
```

ç„¶ååˆ›å»º `.cargo/config.toml`ï¼ŒæŒ‡å®šç›®æ ‡æ¶æ„ï¼š

```toml
[build]
target = "thumbv7m-none-eabi"
```

ç¼–è¾‘ `Cargo.toml` æ·»åŠ ä¾èµ–ï¼š

```toml
[dependencies]
cortex-m = "0.7"
cortex-m-rt = "0.7"
panic-halt = "0.2"
stm32f1xx-hal = "0.10"
```

ç¼–å†™æœ€å°åŒ–è£¸æœºä»£ç ï¼ˆ`src/main.rs`ï¼‰ï¼š

```rust
#![no_std]
#![no_main]

use cortex_m_rt::entry;
use panic_halt as _;

#[entry]
fn main() -> ! {
    loop {
        // ä½ çš„è£¸æœºé€»è¾‘å†™è¿™
    }
}
```

æ„å»ºé¡¹ç›®ï¼š

```bash
cargo build --release
```

çƒ§å½•è¿› STM32F103ï¼š

```bash
cargo flash --chip STM32F103C8 --release
```

------

## ğŸ§¼ æ•´ä½“æµç¨‹æ€»ç»“

| æ­¥éª¤         | å‘½ä»¤                                    |
| ------------ | --------------------------------------- |
| æ·»åŠ ç›®æ ‡     | `rustup target add thumbv7m-none-eabi`  |
| å®‰è£… linker  | å®‰è£… `arm-none-eabi-gcc` å¹¶é…ç½®ç¯å¢ƒå˜é‡ |
| å®‰è£…çƒ§å½•å·¥å…· | `cargo install cargo-flash` ç­‰          |
| åˆ›å»ºé¡¹ç›®     | `cargo new your_proj --bin`             |
| æ„å»ºé¡¹ç›®     | `cargo build --release`                 |
| çƒ§å½•åˆ°æ¿å­   | `cargo flash --chip STM32F103C8`        |



------

## ğŸ§  ä¸€äº›è¡¥å……å»ºè®®

- `stm32f1xx-hal` æ˜¯å®˜æ–¹ HALï¼Œéå¸¸æˆç†Ÿ
- ä½¿ç”¨ `probe-rs` å¯ä»¥å®ç° RTTã€è°ƒè¯•æ‰“å°ç­‰é«˜çº§åŠŸèƒ½
- å¦‚æœä½ ç†Ÿæ‚‰ `openocd` æˆ– `stlink`ï¼Œä¹Ÿå¯ä»¥ç”¨ä¼ ç»Ÿæ–¹å¼çƒ§å½• `.bin`

------

## ğŸ’¬ ç»“è¯­

Rust ç©åµŒå…¥å¼å·²ç»ä¸å†æ˜¯å®éªŒå®¤é‡Œçš„é»‘é­”æ³•ï¼Œç°åœ¨ä½ å®Œå…¨å¯ä»¥æŠŠ STM32F1 ææˆè‡ªå·±çš„ playgroundï¼Œå†™å‡ºæ—¢ä¼˜é›…åˆå®‰å…¨çš„è£¸æœºé€»è¾‘ã€‚æ¯” C æ›´ç¡¬æ ¸ï¼Œæ¯” Python æ›´ä¸“ä¸šï¼Œè¿™æ‰æ˜¯ç°ä»£å·¥ç¨‹å¸ˆè¯¥æœ‰çš„å§¿åŠ¿ã€‚