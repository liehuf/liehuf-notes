---
title: 1.c8t6的Rust环境搭建
date: 2025-06-27 9:22:49
permalink: /pages/Rust_01/
---

# 🚀 在 Windows 上为 STM32F103C8T6 安装 Rust 工具链（2025 最新版）

Rust 想玩嵌入式？那必须得上 ARM Cortex-M 系列板子——经典中的经典，**STM32F103C8T6（俗称“蓝丁板”）**就是入坑的首选。本篇文章手把手教你如何在 Windows 上为它配置 Rust 工具链，让你的 `main.rs` 比裸机 C 还干净利落。

## 🧱 前提准备

确保你已经安装好：

- Rust 官方工具链（用 rustup 安装，默认即可）
- VSCode + rust-analyzer（可选但推荐）
- ST-Link 调试器（烧录用）

命令行确认 Rust 安装成功：

```bash
rustc --version
cargo --version
```

------

## 🛠️ 第一步：添加目标架构

STM32F103 属于 Cortex-M3 内核，用的是 `thumbv7m-none-eabi` 架构。

执行命令：

```bash
rustup target add thumbv7m-none-eabi
```

------

## 🔧 第二步：安装交叉编译工具链（GCC）

Rust 编译器本身不带 linker，需要 ARM 的裸机工具链。

你可以安装：

### 方法1：xPack Arm Toolchain（推荐）

访问：

> https://xpack.github.io/arm-none-eabi-gcc/install/

下载 Windows 版，安装后将其 `bin` 目录添加到系统环境变量 `PATH`。

比如：

```bash
D:\xpack-arm-none-eabi-gcc\bin
```

验证是否安装成功：

```bash
arm-none-eabi-gcc --version
```

------

## 🔌 第三步：安装 probe-rs 和 cargo-flash

用于**读取芯片信息、烧录程序、调试**等功能。

```bash
cargo install cargo-binutils
rustup component add llvm-tools-preview
cargo install probe-rs
cargo install cargo-flash
```

------

## 🔍 第四步：确认调试器是否连接

插好 ST-Link，使用：

```bash
cargo flash --list-probes
```

能看到设备信息就说明你的调试器连接正常。

------

## 📦 第五步（可选）：创建一个测试项目

```bash
cargo new f103-blink --bin
cd f103-blink
```

然后创建 `.cargo/config.toml`，指定目标架构：

```toml
[build]
target = "thumbv7m-none-eabi"
```

编辑 `Cargo.toml` 添加依赖：

```toml
[dependencies]
cortex-m = "0.7"
cortex-m-rt = "0.7"
panic-halt = "0.2"
stm32f1xx-hal = "0.10"
```

编写最小化裸机代码（`src/main.rs`）：

```rust
#![no_std]
#![no_main]

use cortex_m_rt::entry;
use panic_halt as _;

#[entry]
fn main() -> ! {
    loop {
        // 你的裸机逻辑写这
    }
}
```

构建项目：

```bash
cargo build --release
```

烧录进 STM32F103：

```bash
cargo flash --chip STM32F103C8 --release
```

------

## 🧼 整体流程总结

| 步骤         | 命令                                    |
| ------------ | --------------------------------------- |
| 添加目标     | `rustup target add thumbv7m-none-eabi`  |
| 安装 linker  | 安装 `arm-none-eabi-gcc` 并配置环境变量 |
| 安装烧录工具 | `cargo install cargo-flash` 等          |
| 创建项目     | `cargo new your_proj --bin`             |
| 构建项目     | `cargo build --release`                 |
| 烧录到板子   | `cargo flash --chip STM32F103C8`        |



------

## 🧠 一些补充建议

- `stm32f1xx-hal` 是官方 HAL，非常成熟
- 使用 `probe-rs` 可以实现 RTT、调试打印等高级功能
- 如果你熟悉 `openocd` 或 `stlink`，也可以用传统方式烧录 `.bin`

------

## 💬 结语

Rust 玩嵌入式已经不再是实验室里的黑魔法，现在你完全可以把 STM32F1 搞成自己的 playground，写出既优雅又安全的裸机逻辑。比 C 更硬核，比 Python 更专业，这才是现代工程师该有的姿势。