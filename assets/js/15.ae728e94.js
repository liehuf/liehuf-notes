(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{384:function(t,s,a){"use strict";a.r(s);var n=a(2),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("p",[t._v("本章用于记录我在学习卷积神经网络（CNN）过程中，\n对卷积相关概念以及初代经典 CNN —— "),s("strong",[t._v("LeNet")]),t._v(" 的结构理解。")]),t._v(" "),s("h2",{attrs:{id:"一、卷积相关知识点"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#一、卷积相关知识点"}},[t._v("#")]),t._v(" 一、卷积相关知识点")]),t._v(" "),s("h3",{attrs:{id:"_1-卷积-convolution"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-卷积-convolution"}},[t._v("#")]),t._v(" 1. 卷积（Convolution）")]),t._v(" "),s("p",[t._v("在深度学习中，卷积运算本质上更接近于"),s("strong",[t._v("互相关（cross-correlation）")]),t._v("。")]),t._v(" "),s("p",[t._v("可以形象地理解为："),s("br"),t._v("\n一个较小的卷积核（kernel）在一张较大的输入特征图上，从左到右、从上到下滑动，\n在每一个位置与局部区域进行加权求和，从而生成新的"),s("strong",[t._v("特征图（feature map）")]),t._v("。")]),t._v(" "),s("hr"),t._v(" "),s("h3",{attrs:{id:"_2-填充-padding"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-填充-padding"}},[t._v("#")]),t._v(" 2. 填充（Padding）")]),t._v(" "),s("p",[t._v("填充是指在输入特征图的边缘补充若干行或列的像素。")]),t._v(" "),s("p",[t._v("其主要目的包括：")]),t._v(" "),s("ul",[s("li",[t._v("控制输出特征图的空间尺寸")]),t._v(" "),s("li",[t._v("保留输入图像边缘的信息")])]),t._v(" "),s("p",[t._v("通常用 "),s("eq",[s("span",{staticClass:"katex"},[s("span",{staticClass:"katex-mathml"},[s("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[s("semantics",[s("mrow",[s("mi",[t._v("P")])],1),s("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("P")])],1)],1)],1),s("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[s("span",{staticClass:"base"},[s("span",{staticClass:"strut",staticStyle:{height:"0.68333em","vertical-align":"0em"}}),s("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.13889em"}},[t._v("P")])])])])]),t._v(" 表示填充的像素数。")],1),t._v(" "),s("hr"),t._v(" "),s("h3",{attrs:{id:"_3-步幅-stride"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-步幅-stride"}},[t._v("#")]),t._v(" 3. 步幅（Stride）")]),t._v(" "),s("p",[t._v("步幅表示卷积核在输入特征图上"),s("strong",[t._v("每次滑动的像素数")]),t._v("，通常记为 "),s("eq",[s("span",{staticClass:"katex"},[s("span",{staticClass:"katex-mathml"},[s("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[s("semantics",[s("mrow",[s("mi",[t._v("S")])],1),s("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("S")])],1)],1)],1),s("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[s("span",{staticClass:"base"},[s("span",{staticClass:"strut",staticStyle:{height:"0.68333em","vertical-align":"0em"}}),s("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.05764em"}},[t._v("S")])])])])]),t._v("。")],1),t._v(" "),s("ul",[s("li",[s("eq",[s("span",{staticClass:"katex"},[s("span",{staticClass:"katex-mathml"},[s("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[s("semantics",[s("mrow",[s("mi",[t._v("S")]),s("mo",[t._v("=")]),s("mn",[t._v("1")])],1),s("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("S = 1")])],1)],1)],1),s("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[s("span",{staticClass:"base"},[s("span",{staticClass:"strut",staticStyle:{height:"0.68333em","vertical-align":"0em"}}),s("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.05764em"}},[t._v("S")]),s("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),s("span",{staticClass:"mrel"},[t._v("=")]),s("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),s("span",{staticClass:"base"},[s("span",{staticClass:"strut",staticStyle:{height:"0.64444em","vertical-align":"0em"}}),s("span",{staticClass:"mord"},[t._v("1")])])])])]),t._v("：逐像素滑动（最常见）")],1),t._v(" "),s("li",[s("eq",[s("span",{staticClass:"katex"},[s("span",{staticClass:"katex-mathml"},[s("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[s("semantics",[s("mrow",[s("mi",[t._v("S")]),s("mo",[t._v(">")]),s("mn",[t._v("1")])],1),s("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("S > 1")])],1)],1)],1),s("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[s("span",{staticClass:"base"},[s("span",{staticClass:"strut",staticStyle:{height:"0.72243em","vertical-align":"-0.0391em"}}),s("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.05764em"}},[t._v("S")]),s("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),s("span",{staticClass:"mrel"},[t._v(">")]),s("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),s("span",{staticClass:"base"},[s("span",{staticClass:"strut",staticStyle:{height:"0.64444em","vertical-align":"0em"}}),s("span",{staticClass:"mord"},[t._v("1")])])])])]),t._v("：下采样效果，输出尺寸减小")],1)]),t._v(" "),s("hr"),t._v(" "),s("h3",{attrs:{id:"_4-神经网络中的张量表示"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-神经网络中的张量表示"}},[t._v("#")]),t._v(" 4. 神经网络中的张量表示")]),t._v(" "),s("p",[t._v("在卷积神经网络中，输入数据通常表示为一个 "),s("strong",[t._v("四维张量")]),t._v("：")]),t._v(" "),s("section",[s("eqn",[s("span",{staticClass:"katex-display"},[s("span",{staticClass:"katex"},[s("span",{staticClass:"katex-mathml"},[s("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[s("semantics",[s("mrow",[s("mtext",{attrs:{mathvariant:"monospace"}},[t._v("(batch_size,")]),s("mtext"),s("mtext",{attrs:{mathvariant:"monospace"}},[t._v("channels,")]),s("mtext"),s("mtext",{attrs:{mathvariant:"monospace"}},[t._v("height,")]),s("mtext"),s("mtext",{attrs:{mathvariant:"monospace"}},[t._v("width)")])],1),s("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\n\\texttt{(batch\\_size,\\ channels,\\ height,\\ width)}\n")])],1)],1)],1),s("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[s("span",{staticClass:"base"},[s("span",{staticClass:"strut",staticStyle:{height:"0.9166599999999999em","vertical-align":"-0.22222em"}}),s("span",{staticClass:"mord text"},[s("span",{staticClass:"mord texttt"},[t._v("(batch_size, channels, height, width)")])])])])])])])],1),s("p",[t._v("各个维度的含义如下：")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("batch_size")]),t._v("：批量大小，一次输入网络的样本数量")]),t._v(" "),s("li",[s("strong",[t._v("channels")]),t._v("：通道数（如灰度图为 1，RGB 图像为 3）")]),t._v(" "),s("li",[s("strong",[t._v("height")]),t._v("：特征图高度")]),t._v(" "),s("li",[s("strong",[t._v("width")]),t._v("：特征图宽度")])]),t._v(" "),s("hr"),t._v(" "),s("h3",{attrs:{id:"_5-池化-pooling"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-池化-pooling"}},[t._v("#")]),t._v(" 5. 池化（Pooling）")]),t._v(" "),s("p",[t._v("池化操作与卷积类似，同样在局部区域内进行运算，但有以下特点：")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("不改变通道数")])]),t._v(" "),s("li",[t._v("主要作用是减小特征图的空间尺寸")]),t._v(" "),s("li",[t._v("提升平移不变性，降低计算量")])]),t._v(" "),s("p",[t._v("常见的池化方式包括平均池化（Avg Pooling）和最大池化（Max Pooling）。")]),t._v(" "),s("hr"),t._v(" "),s("h3",{attrs:{id:"_6-卷积与池化的输出尺寸计算"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-卷积与池化的输出尺寸计算"}},[t._v("#")]),t._v(" 6. 卷积与池化的输出尺寸计算")]),t._v(" "),s("p",[t._v("对于卷积或池化操作，其输出特征图的空间尺寸计算公式为：")]),t._v(" "),s("section",[s("eqn",[s("span",{staticClass:"katex-display"},[s("span",{staticClass:"katex"},[s("span",{staticClass:"katex-mathml"},[s("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[s("semantics",[s("mrow",[s("mtext",[t._v("output_size")]),s("mo",[t._v("=")]),s("mrow",[s("mo",{attrs:{fence:"true"}},[t._v("⌊")]),s("mfrac",[s("mrow",[s("mtext",[t._v("input_size")]),s("mo",[t._v("−")]),s("mi",[t._v("K")]),s("mo",[t._v("+")]),s("mn",[t._v("2")]),s("mi",[t._v("P")])],1),s("mi",[t._v("S")])],1),s("mo",{attrs:{fence:"true"}},[t._v("⌋")])],1),s("mo",[t._v("+")]),s("mn",[t._v("1")])],1),s("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\n\\text{output\\_size}\n=\n\\left\\lfloor\n\\frac{\\text{input\\_size} - K + 2P}{S}\n\\right\\rfloor\n+ 1\n")])],1)],1)],1),s("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[s("span",{staticClass:"base"},[s("span",{staticClass:"strut",staticStyle:{height:"0.97786em","vertical-align":"-0.31em"}}),s("span",{staticClass:"mord text"},[s("span",{staticClass:"mord"},[t._v("output_size")])]),s("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),s("span",{staticClass:"mrel"},[t._v("=")]),s("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),s("span",{staticClass:"base"},[s("span",{staticClass:"strut",staticStyle:{height:"2.40003em","vertical-align":"-0.95003em"}}),s("span",{staticClass:"minner"},[s("span",{staticClass:"mopen delimcenter",staticStyle:{top:"0em"}},[s("span",{staticClass:"delimsizing size3"},[t._v("⌊")])]),s("span",{staticClass:"mord"},[s("span",{staticClass:"mopen nulldelimiter"}),s("span",{staticClass:"mfrac"},[s("span",{staticClass:"vlist-t vlist-t2"},[s("span",{staticClass:"vlist-r"},[s("span",{staticClass:"vlist",staticStyle:{height:"1.38333em"}},[s("span",{staticStyle:{top:"-2.314em"}},[s("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),s("span",{staticClass:"mord"},[s("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.05764em"}},[t._v("S")])])]),s("span",{staticStyle:{top:"-3.23em"}},[s("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),s("span",{staticClass:"frac-line",staticStyle:{"border-bottom-width":"0.04em"}})]),s("span",{staticStyle:{top:"-3.6999999999999997em"}},[s("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),s("span",{staticClass:"mord"},[s("span",{staticClass:"mord text"},[s("span",{staticClass:"mord"},[t._v("input_size")])]),s("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),s("span",{staticClass:"mbin"},[t._v("−")]),s("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),s("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.07153em"}},[t._v("K")]),s("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),s("span",{staticClass:"mbin"},[t._v("+")]),s("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),s("span",{staticClass:"mord"},[t._v("2")]),s("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.13889em"}},[t._v("P")])])])]),s("span",{staticClass:"vlist-s"},[t._v("​")])]),s("span",{staticClass:"vlist-r"},[s("span",{staticClass:"vlist",staticStyle:{height:"0.686em"}},[s("span")])])])]),s("span",{staticClass:"mclose nulldelimiter"})]),s("span",{staticClass:"mclose delimcenter",staticStyle:{top:"0em"}},[s("span",{staticClass:"delimsizing size3"},[t._v("⌋")])])]),s("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),s("span",{staticClass:"mbin"},[t._v("+")]),s("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}})]),s("span",{staticClass:"base"},[s("span",{staticClass:"strut",staticStyle:{height:"0.64444em","vertical-align":"0em"}}),s("span",{staticClass:"mord"},[t._v("1")])])])])])])],1),s("p",[t._v("其中：")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("input_size")]),t._v("：输入特征图的高度或宽度")]),t._v(" "),s("li",[s("strong",[t._v("K")]),t._v("：卷积核（或池化核）的尺寸")]),t._v(" "),s("li",[s("strong",[t._v("P")]),t._v("：填充大小（padding）")]),t._v(" "),s("li",[s("strong",[t._v("S")]),t._v("：步幅（stride）")]),t._v(" "),s("li",[s("eq",[s("span",{staticClass:"katex"},[s("span",{staticClass:"katex-mathml"},[s("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[s("semantics",[s("mrow",[s("mo",{attrs:{stretchy:"false"}},[t._v("⌊")]),s("mo",[t._v("⋅")]),s("mo",{attrs:{stretchy:"false"}},[t._v("⌋")])],1),s("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\lfloor \\cdot \\rfloor")])],1)],1)],1),s("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[s("span",{staticClass:"base"},[s("span",{staticClass:"strut",staticStyle:{height:"1em","vertical-align":"-0.25em"}}),s("span",{staticClass:"mopen"},[t._v("⌊")]),s("span",{staticClass:"mord"},[t._v("⋅")]),s("span",{staticClass:"mclose"},[t._v("⌋")])])])])]),t._v("：向下取整")],1)]),t._v(" "),s("hr"),t._v(" "),s("h2",{attrs:{id:"二、lenet-网络结构"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#二、lenet-网络结构"}},[t._v("#")]),t._v(" 二、LeNet 网络结构")]),t._v(" "),s("p",[t._v("下面使用 PyTorch 代码的形式，对经典 CNN —— "),s("strong",[t._v("LeNet")]),t._v(" 的整体结构进行说明。")]),t._v(" "),s("div",{staticClass:"language-python line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("net "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" nn"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Sequential"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    nn"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Conv2d"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" kernel_size"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" padding"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 第一层卷积")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 输入通道数为 1（灰度图），输出通道数为 6")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# padding=2，使输出特征图尺寸保持为 28×28")]),t._v("\n\n    nn"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Sigmoid"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 激活函数")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 将卷积结果映射到 (0, 1) 区间")]),t._v("\n\n    nn"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("AvgPool2d"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("kernel_size"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" stride"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 平均池化层")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 不改变通道数，仅将特征图宽高减半：28 -> 14")]),t._v("\n\n    nn"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Conv2d"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" kernel_size"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 第二层卷积")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 输入通道数为 6，输出通道数为 16")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 特征图尺寸：14 -> 10")]),t._v("\n\n    nn"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Sigmoid"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 激活函数")]),t._v("\n\n    nn"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("AvgPool2d"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("kernel_size"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" stride"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 平均池化层")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 特征图尺寸：10 -> 5")]),t._v("\n\n    nn"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Flatten"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 展平层")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 将张量从 (16, 5, 5) 展平成 (400,)")]),t._v("\n\n    nn"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Linear"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("400")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("120")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 全连接层")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 输入维度 400，输出维度 120")]),t._v("\n\n    nn"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Sigmoid"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 激活函数")]),t._v("\n\n    nn"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Linear"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("120")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("84")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 全连接层")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 通道数：120 -> 84")]),t._v("\n\n    nn"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Sigmoid"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 激活函数")]),t._v("\n\n    nn"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Linear"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("84")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 输出层")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 输出维度等于类别数")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")])])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br"),s("span",{staticClass:"line-number"},[t._v("19")]),s("br"),s("span",{staticClass:"line-number"},[t._v("20")]),s("br"),s("span",{staticClass:"line-number"},[t._v("21")]),s("br"),s("span",{staticClass:"line-number"},[t._v("22")]),s("br"),s("span",{staticClass:"line-number"},[t._v("23")]),s("br"),s("span",{staticClass:"line-number"},[t._v("24")]),s("br"),s("span",{staticClass:"line-number"},[t._v("25")]),s("br"),s("span",{staticClass:"line-number"},[t._v("26")]),s("br"),s("span",{staticClass:"line-number"},[t._v("27")]),s("br"),s("span",{staticClass:"line-number"},[t._v("28")]),s("br"),s("span",{staticClass:"line-number"},[t._v("29")]),s("br"),s("span",{staticClass:"line-number"},[t._v("30")]),s("br"),s("span",{staticClass:"line-number"},[t._v("31")]),s("br"),s("span",{staticClass:"line-number"},[t._v("32")]),s("br"),s("span",{staticClass:"line-number"},[t._v("33")]),s("br"),s("span",{staticClass:"line-number"},[t._v("34")]),s("br"),s("span",{staticClass:"line-number"},[t._v("35")]),s("br"),s("span",{staticClass:"line-number"},[t._v("36")]),s("br"),s("span",{staticClass:"line-number"},[t._v("37")]),s("br"),s("span",{staticClass:"line-number"},[t._v("38")]),s("br"),s("span",{staticClass:"line-number"},[t._v("39")]),s("br"),s("span",{staticClass:"line-number"},[t._v("40")]),s("br"),s("span",{staticClass:"line-number"},[t._v("41")]),s("br"),s("span",{staticClass:"line-number"},[t._v("42")]),s("br"),s("span",{staticClass:"line-number"},[t._v("43")]),s("br"),s("span",{staticClass:"line-number"},[t._v("44")]),s("br"),s("span",{staticClass:"line-number"},[t._v("45")]),s("br"),s("span",{staticClass:"line-number"},[t._v("46")]),s("br"),s("span",{staticClass:"line-number"},[t._v("47")]),s("br")])])])}),[],!1,null,null,null);s.default=e.exports}}]);