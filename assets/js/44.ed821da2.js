(window.webpackJsonp=window.webpackJsonp||[]).push([[44],{415:function(s,a,e){"use strict";e.r(a);var t=e(2),v=Object(t.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"linux-磁盘管理-df-du-分区与挂载"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#linux-磁盘管理-df-du-分区与挂载"}},[s._v("#")]),s._v(" Linux 磁盘管理（df / du / 分区与挂载）")]),s._v(" "),a("p",[s._v("本文记录一次在 "),a("strong",[s._v("Ubuntu 22.04")]),s._v(" 上进行的磁盘管理实践，目标不是“记命令”，而是建立"),a("strong",[s._v("磁盘空间是如何被 Linux 感知、统计和使用的完整认知模型")]),s._v("。"),a("br"),s._v("\n核心工具只有三个："),a("code",[s._v("df")]),s._v("、"),a("code",[s._v("du")]),s._v("、"),a("code",[s._v("lsblk / mount")]),s._v("。")]),s._v(" "),a("hr"),s._v(" "),a("h2",{attrs:{id:"一、df-从「文件系统」视角看磁盘空间"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一、df-从「文件系统」视角看磁盘空间"}},[s._v("#")]),s._v(" 一、df：从「文件系统」视角看磁盘空间")]),s._v(" "),a("h3",{attrs:{id:"_1-df-在看什么"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-df-在看什么"}},[s._v("#")]),s._v(" 1. df 在看什么？")]),s._v(" "),a("p",[a("code",[s._v("df")]),s._v("（disk free）"),a("strong",[s._v("统计的是“已挂载文件系统”的整体空间使用情况")]),s._v("，而不是某个具体目录或文件。")]),s._v(" "),a("p",[s._v("实践命令：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("df")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-h")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("实践输出（部分）：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("文件系统         大小   已用  可用  已用%   挂载点\n/dev/sda3        20G   12G  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(".0G   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("62")]),s._v("%  /\ntmpfs           961M     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  961M    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("%  /dev/shm\n/dev/sda2       512M  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(".1M  506M    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("%  /boot/efi\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("关键列含义：")]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("文件系统")]),s._v("：底层设备或虚拟文件系统")]),s._v(" "),a("li",[a("strong",[s._v("大小 / 已用 / 可用 / 已用%")]),s._v("：整体容量统计")]),s._v(" "),a("li",[a("strong",[s._v("挂载点")]),s._v("：该文件系统“接管”的目录位置")])]),s._v(" "),a("p",[s._v("结论性理解：")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("df")]),s._v(" 关心的是 "),a("strong",[s._v("“哪个文件系统挂载到哪里，用了多少空间”")])]),s._v(" "),a("li",[s._v("日常最重要的挂载点只有一个："),a("code",[s._v("/")]),s._v("（根文件系统）")])]),s._v(" "),a("h3",{attrs:{id:"_2-一个常见错误-df-不能加-max-depth"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-一个常见错误-df-不能加-max-depth"}},[s._v("#")]),s._v(" 2. 一个常见错误：df 不能加 "),a("code",[s._v("--max-depth")])]),s._v(" "),a("p",[s._v("实践中出现的错误：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("df")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-h")]),s._v(" /home --max-depth"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("系统返回：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("df: 未识别的选项 "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"--max-depth=1"')]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("原因很简单但很关键：")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("df")]),s._v(" "),a("strong",[s._v("不看目录结构")])]),s._v(" "),a("li",[a("code",[s._v("--max-depth")]),s._v(" 是 "),a("code",[s._v("du")]),s._v(" 的参数，不是 "),a("code",[s._v("df")]),s._v(" 的")])]),s._v(" "),a("p",[s._v("这也从侧面说明：\n"),a("strong",[s._v("df 和 du 的职责完全不同，不能混用思维方式。")])]),s._v(" "),a("h2",{attrs:{id:"二、du-从「目录-文件」视角找空间来源"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#二、du-从「目录-文件」视角找空间来源"}},[s._v("#")]),s._v(" 二、du：从「目录 / 文件」视角找空间来源")]),s._v(" "),a("h3",{attrs:{id:"_1-du-在看什么"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-du-在看什么"}},[s._v("#")]),s._v(" 1. du 在看什么？")]),s._v(" "),a("p",[a("code",[s._v("du")]),s._v("（disk usage）统计的是：\n"),a("strong",[s._v("某个目录或文件，实际占用了多少磁盘空间")])]),s._v(" "),a("p",[s._v("当你遇到：")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("df -h")]),s._v(" 显示磁盘快满了")]),s._v(" "),a("li",[s._v("但你不知道“空间被谁吃了”")])]),s._v(" "),a("p",[s._v("那么答案一定在 "),a("code",[s._v("du")]),s._v("。")]),s._v(" "),a("hr"),s._v(" "),a("h3",{attrs:{id:"_2-典型实践-查看-home-下各目录占用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-典型实践-查看-home-下各目录占用"}},[s._v("#")]),s._v(" 2. 典型实践：查看 "),a("code",[s._v("/home")]),s._v(" 下各目录占用")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("du")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-h")]),s._v(" /home --max-depth"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("实践输出：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("84M\t/home/ikun\n84M\t/home\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("解释：")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("/home/ikun")]),s._v(" 占用约 84MB")]),s._v(" "),a("li",[a("code",[s._v("/home")]),s._v(" 总体占用也是 84MB，说明当前只有一个用户目录")])]),s._v(" "),a("p",[s._v("关键认知：")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("du")]),s._v(" 是"),a("strong",[s._v("定位元凶的工具")])]),s._v(" "),a("li",[a("code",[s._v("--max-depth=1")]),s._v(" 用于限制展开层级，避免信息爆炸")])]),s._v(" "),a("hr"),s._v(" "),a("h3",{attrs:{id:"_3-df-du-的固定排查思路"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-df-du-的固定排查思路"}},[s._v("#")]),s._v(" 3. df + du 的固定排查思路")]),s._v(" "),a("p",[s._v("一条可以长期复用的排查路径：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("df")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-h")]),s._v("               "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 判断哪个文件系统快满了")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("du")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-h")]),s._v(" / --max-depth"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("du")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-h")]),s._v(" /home --max-depth"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("du")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-sh")]),s._v(" 某个可疑目录\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("这是"),a("strong",[s._v("从文件系统 → 目录 → 子目录的漏斗式定位")]),s._v("。")]),s._v(" "),a("h2",{attrs:{id:"三、lsblk-理解-磁盘-分区-挂载-的结构关系"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#三、lsblk-理解-磁盘-分区-挂载-的结构关系"}},[s._v("#")]),s._v(" 三、lsblk：理解“磁盘 / 分区 / 挂载”的结构关系")]),s._v(" "),a("h3",{attrs:{id:"_1-为什么需要-lsblk"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-为什么需要-lsblk"}},[s._v("#")]),s._v(" 1. 为什么需要 lsblk？")]),s._v(" "),a("p",[s._v("Linux 下：")]),s._v(" "),a("ul",[a("li",[s._v("没有盘符（C: / D:）")]),s._v(" "),a("li",[s._v("只有 "),a("strong",[s._v("设备 → 分区 → 挂载点")])])]),s._v(" "),a("p",[a("code",[s._v("lsblk")]),s._v(" 用树形结构把这三者一次性展示出来。")]),s._v(" "),a("p",[s._v("实践命令：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("lsblk\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("实践输出（部分）：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("sda      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(":0    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("    20G  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" disk \n├─sda2   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(":2    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("   513M  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" part /boot/efi\n└─sda3   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(":3    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(".5G  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" part /\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("逐层理解：")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("sda")]),s._v("：一整块磁盘（20G）")]),s._v(" "),a("li",[a("code",[s._v("sda2")]),s._v("：一个分区，挂载到 "),a("code",[s._v("/boot/efi")])]),s._v(" "),a("li",[a("code",[s._v("sda3")]),s._v("：一个分区，挂载到 "),a("code",[s._v("/")]),s._v("（根文件系统）")])]),s._v(" "),a("p",[s._v("结论性理解：")]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("磁盘 ≠ 可直接使用")])]),s._v(" "),a("li",[a("strong",[s._v("分区必须被挂载到某个目录，空间才“生效”")])])]),s._v(" "),a("hr"),s._v(" "),a("h3",{attrs:{id:"_2-loop-设备是什么"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-loop-设备是什么"}},[s._v("#")]),s._v(" 2. loop 设备是什么？")]),s._v(" "),a("p",[s._v("在输出中还看到大量 "),a("code",[s._v("loop")]),s._v(" 设备：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("loop0  /snap/core22/2292\nloop2  /snap/firefox/7836\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("它们的本质是：")]),s._v(" "),a("ul",[a("li",[s._v("snap 包使用的 "),a("strong",[s._v("只读镜像文件")])]),s._v(" "),a("li",[s._v("被“虚拟成块设备”再挂载")])]),s._v(" "),a("p",[s._v("这类设备通常：")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("RO = 1")]),s._v("（只读）")]),s._v(" "),a("li",[s._v("不参与普通磁盘空间管理")]),s._v(" "),a("li",[s._v("不要误认为是“真实磁盘”")])]),s._v(" "),a("hr"),s._v(" "),a("h2",{attrs:{id:"四、mount-验证-谁被挂载到了哪里"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#四、mount-验证-谁被挂载到了哪里"}},[s._v("#")]),s._v(" 四、mount：验证“谁被挂载到了哪里”")]),s._v(" "),a("p",[s._v("实践命令：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mount")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("less")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[a("code",[s._v("mount")]),s._v(" 输出的是"),a("strong",[s._v("当前系统所有已挂载的文件系统")]),s._v("，格式类似：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("/dev/sda3 on / "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("type")]),s._v(" ext4 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("rw,relatime"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("这句话完整表达了：")]),s._v(" "),a("ul",[a("li",[s._v("哪个设备："),a("code",[s._v("/dev/sda3")])]),s._v(" "),a("li",[s._v("挂载到哪里："),a("code",[s._v("/")])]),s._v(" "),a("li",[s._v("使用什么文件系统："),a("code",[s._v("ext4")])]),s._v(" "),a("li",[s._v("挂载属性：读写、时间策略等")])]),s._v(" "),a("p",[s._v("核心认知：")]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("lsblk 看结构")])]),s._v(" "),a("li",[a("strong",[s._v("mount 看当前生效状态")])]),s._v(" "),a("li",[s._v("两者结合，才能真正理解磁盘是“怎么用起来的”")])])])}),[],!1,null,null,null);a.default=v.exports}}]);